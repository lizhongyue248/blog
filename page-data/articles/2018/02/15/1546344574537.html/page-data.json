{"componentChunkName":"component---src-templates-post-tsx","path":"/articles/2018/02/15/1546344574537.html","result":{"data":{"asciidoc":{"id":"38029a65-f8e3-5f39-b5c4-b9b90731bb2e","fields":{"slug":"/articles/2018/02/15/1546344574537.html","birthTime":"2018-02-14T22:16:00.000Z","modifiedTime":"2019-01-01T12:45:12.259Z"},"html":"<div id=\"toc\" class=\"toc\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<div id=\"toctitle\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">Table of Contents</div>\n<ul class=\"sectlevel1\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<li data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\"><a href=\"#_操作\">操作</a></li>\n</ul>\n</div>\n<div id=\"preamble\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<div class=\"sectionbody\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<div class=\"quoteblock\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<blockquote>\n<div class=\"paragraph\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<p>在 serverx和 desktopx上设置防火墙，对 SSH实现访问限制： - 允许\nexample.com域的客户对 serverx和 desktopx进行 ssh访问。 - 禁止\nmy133t.org域的客户对 serverx和 desktopx进行 ssh访问。 - 备注：\nmy133t.org是在172．17．10℃/24网络。 - 根据考试实际提供的网段配置</p>\n</div>\n</blockquote>\n</div>\n</div>\n</div>\n<div class=\"sect1\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<h2 id=\"_操作\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">操作</h2>\n<div class=\"sectionbody\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<div class=\"paragraph\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<p>—&gt;防火墙会检查的部分</p>\n</div>\n<div class=\"paragraph\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<p>（1）IP来源 （信任域、非信任域）</p>\n</div>\n<div class=\"paragraph\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<p>（2）访问的对象 （服务ssh/http、端口）</p>\n</div>\n<div class=\"paragraph\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<p>（3）访问的协议 （TCP/UDP）</p>\n</div>\n<div class=\"paragraph\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<p>（4）目标IP （防火墙设备，例如路由器NAT）</p>\n</div>\n<div class=\"olist arabic\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<ol class=\"arabic\">\n<li data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<p>关闭与屏蔽 iptables 以及其他防火墙</p>\n</li>\n</ol>\n</div>\n<div class=\"listingblock\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<div class=\"content\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<pre class=\"highlight\"><code class=\"language-bash\" data-lang=\"bash\">systemctl  mask  ebtables.service\nsystemctl  mask  iptables\nsystemctl  mask  ip6tables</code></pre>\n</div>\n</div>\n<div class=\"olist arabic\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<ol class=\"arabic\" start=\"2\">\n<li data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<p>开启 firewalld 防火墙以及开机启动</p>\n</li>\n</ol>\n</div>\n<div class=\"listingblock\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<div class=\"content\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<pre class=\"highlight\"><code class=\"language-bash\" data-lang=\"bash\">systemctl  enable  firewalld\nsystemctl  start  firewalld</code></pre>\n</div>\n</div>\n<div class=\"olist arabic\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<ol class=\"arabic\" start=\"3\">\n<li data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<p>配置防火墙富规则</p>\n</li>\n</ol>\n</div>\n<div class=\"listingblock\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<div class=\"content\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<pre class=\"highlight\"><code class=\"language-bash\" data-lang=\"bash\">mandb                   //更新 man\nman  -k  rich              //查询防火墙副规则的 man 路径\nman  firewalld.richlanguage     //防火墙富规则查询</code></pre>\n</div>\n</div>\n<div class=\"imageblock\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<div class=\"content\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<img src=\"https://resources.echocow.cn/image/rhce/2.1.png\" alt=\"规则查看\">\n</div>\n</div>\n<div class=\"imageblock\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<div class=\"content\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<img src=\"https://resources.echocow.cn/image/rhce/2.2.png\" alt=\"规则\">\n</div>\n</div>\n<table class=\"tableblock frame-all grid-all stretch\">\n<colgroup>\n<col style=\"width: 41%;\">\n<col style=\"width: 33%;\">\n<col style=\"width: 26%;\">\n</colgroup>\n<thead>\n<tr>\n<th class=\"tableblock halign-left valign-top\">名称</th>\n<th class=\"tableblock halign-left valign-top\">含义</th>\n<th class=\"tableblock halign-left valign-top\">值</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">rule</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">类型</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">family=``ipv4</p></td>\n</tr>\n<tr>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">ipv6''</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">source</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">来源/源地址</p></td>\n</tr>\n<tr>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">source address=<code>address[/mask]''\n[invert=</code>True'']</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">destination</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">目的地址</p></td>\n</tr>\n<tr>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">destination address=<code>address[/mask]''\ninvert=</code>True''</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">service</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">服务</p></td>\n</tr>\n<tr>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">service name=``service name''</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">port</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">端口</p></td>\n</tr>\n<tr>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">port port=<code>port value'' protocol=</code>tcp</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">udb''</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">protocol</p></td>\n</tr>\n<tr>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">协议</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">protocol value=``protocol value''</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">ICMP-Block</p></td>\n</tr>\n<tr>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">报文块</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">icmp-block name=``icmptype name''</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">Masquerade</p></td>\n</tr>\n<tr>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">伪装</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">masquerade</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">Forward-Port</p></td>\n</tr>\n<tr>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">转发</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">forward-port port=<code>port value''\nprotocol=</code>tcp</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">udp'' to-port=<code>port value'' to-addr=</code>address''</p></td>\n</tr>\n<tr>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">Log</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">日志</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">log [prefix=<code>prefix text''] [level=</code>log level''] [limit\nvalue=``rate/duration'']</p></td>\n</tr>\n<tr>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">Action</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">审计</p></td>\n<td class=\"tableblock halign-left valign-top\"></td>\n</tr>\n<tr>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">action</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">行为</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">accept, reject or drop</p></td>\n</tr>\n</tbody>\n</table>\n<div class=\"paragraph\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<p>配置具体规则</p>\n</div>\n<div class=\"listingblock\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<div class=\"content\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<pre class=\"highlight\"><code class=\"language-bash\" data-lang=\"bash\">firewall-cmd --add-rich-rule=\"rule family=ipv4 source address=172.25.47.10/24 service name=ssh reject\" --permanent</code></pre>\n</div>\n</div>\n<div class=\"listingblock\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<div class=\"content\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<pre class=\"highlight\"><code class=\"language-bash\" data-lang=\"bash\">firewall-cmd --reload</code></pre>\n</div>\n</div>\n<div class=\"paragraph\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<p><span class=\"image\"><img src=\"https://resources.echocow.cn/image/rhce/2.3.png\" alt=\"image\"></span></p>\n</div>\n</div>\n</div>","document":{"title":"[rhce] 2 配置防火墙对 SSH 的限制"},"pageAttributes":{"category":"rhce","description":"配置防火墙对 SSH 的限制","image":"https://img.hacpai.com/bing/20180104.jpg?imageView2/1/w/1280/h/720/interlace/1/q/100","sort":null}}},"pageContext":{"slug":"/articles/2018/02/15/1546344574537.html","next":{"document":{"title":"[rhce] 3 配置 IPV6 地址"},"fields":{"slug":"/articles/2018/02/15/1546344586289.html"}},"previous":{"document":{"title":"[rhce] 1 配置 SeLinux 为 enforcing"},"fields":{"slug":"/articles/2018/02/14/1546344581049.html"}}}},"staticQueryHashes":["3069561552","3673333084"]}