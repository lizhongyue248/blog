{"componentChunkName":"component---src-templates-post-tsx","path":"/articles/2018/02/02/1546344583722.html","result":{"data":{"asciidoc":{"id":"c065a354-652b-57bb-a18b-edfd243f634f","fields":{"slug":"/articles/2018/02/02/1546344583722.html","birthTime":"2018-02-02T02:01:00.000Z","modifiedTime":"2019-01-01T12:47:12.158Z"},"html":"<div id=\"toc\" class=\"toc\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<div id=\"toctitle\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">Table of Contents</div>\n<ul class=\"sectlevel1\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<li data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\"><a href=\"#_1_配置yum源\">1. 配置YUM源</a></li>\n<li data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\"><a href=\"#_2_安装mysql\">2. 安装MySQL</a></li>\n<li data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\"><a href=\"#_3_启动mysql服务\">3. 启动MySQL服务</a></li>\n<li data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\"><a href=\"#_4_开机启动\">4. 开机启动</a></li>\n<li data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\"><a href=\"#_5_修改root本地登录密码\">5. 修改root本地登录密码</a></li>\n<li data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\"><a href=\"#_6_修改密码策略\">6. 修改密码策略</a>\n<ul class=\"sectlevel2\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<li data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\"><a href=\"#_7_添加远程登录用户\">7. 添加远程登录用户</a></li>\n<li data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\"><a href=\"#_8_配置默认编码为utf8\">8. 配置默认编码为utf8</a></li>\n</ul>\n</li>\n</ul>\n</div>\n<div id=\"preamble\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<div class=\"sectionbody\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<div class=\"quoteblock\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<blockquote>\n<div class=\"paragraph\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<p>安装环境：CentOS7 64位 MINI版，安装MySQL5.7</p>\n</div>\n</blockquote>\n<div class=\"attribution\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n— bash\n</div>\n</div>\n</div>\n</div>\n<div class=\"sect1\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<h2 id=\"_1_配置yum源\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">1. 配置YUM源</h2>\n<div class=\"sectionbody\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<div class=\"paragraph\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<p>在MySQL官网中下载YUM源rpm安装包：http://dev.mysql.com/downloads/repo/yum/</p>\n</div>\n<div class=\"paragraph\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<p>下载mysql源安装包</p>\n</div>\n<div class=\"listingblock\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<div class=\"content\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<pre class=\"highlight\"><code class=\"language-shell\" data-lang=\"shell\">shell&gt; wget https://dev.mysql.com/get/mysql80-community-release-el7-1.noarch.rpm</code></pre>\n</div>\n</div>\n<div class=\"paragraph\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<p>安装mysql源</p>\n</div>\n<div class=\"listingblock\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<div class=\"content\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<pre class=\"highlight\"><code class=\"language-shell\" data-lang=\"shell\">shell&gt; yum localinstall mysql80-community-release-el7-1.noarch.rpm</code></pre>\n</div>\n</div>\n<div class=\"paragraph\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<p>检查mysql源是否安装成功</p>\n</div>\n<div class=\"listingblock\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<div class=\"content\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<pre class=\"highlight\"><code class=\"language-shell\" data-lang=\"shell\">shell&gt; yum repolist enabled | grep \"mysql.*-community.*\"</code></pre>\n</div>\n</div>\n<div class=\"imageblock\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<div class=\"content\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<img src=\"https://resources.echocow.cn/image/blog/centos/1.2.png\" alt=\"2\">\n</div>\n</div>\n<div class=\"paragraph\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<p>看到上图所示表示安装成功。</p>\n</div>\n<div class=\"paragraph\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<p>可以修改vim\n/etc/yum.repos.d/mysql-community.repo源，改变默认安装的mysql版本。比如要安装5.6版本，将5.7源的enabled=1改成enabled=0。然后再将5.6源的enabled=0改成enabled=1即可。改完之后的效果如下所示：</p>\n</div>\n<div class=\"imageblock\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<div class=\"content\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<img src=\"https://resources.echocow.cn/image/blog/centos/1.3.png\" alt=\"2\">\n</div>\n</div>\n</div>\n</div>\n<div class=\"sect1\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<h2 id=\"_2_安装mysql\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">2. 安装MySQL</h2>\n<div class=\"sectionbody\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<div class=\"listingblock\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<div class=\"content\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<pre class=\"highlight\"><code class=\"language-shell\" data-lang=\"shell\">shell&gt; yum install mysql-community-server</code></pre>\n</div>\n</div>\n</div>\n</div>\n<div class=\"sect1\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<h2 id=\"_3_启动mysql服务\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">3. 启动MySQL服务</h2>\n<div class=\"sectionbody\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<div class=\"listingblock\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<div class=\"content\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<pre class=\"highlight\"><code class=\"language-shell\" data-lang=\"shell\">shell&gt; systemctl start mysqld</code></pre>\n</div>\n</div>\n<div class=\"paragraph\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<p>查看MySQL的启动状态</p>\n</div>\n<div class=\"listingblock\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<div class=\"content\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<pre class=\"highlight\"><code class=\"language-shell\" data-lang=\"shell\">shell&gt; systemctl status mysqld\n● mysqld.service - MySQL Server\n   Loaded: loaded (/usr/lib/systemd/system/mysqld.service; disabled; vendor preset: disabled)\n   Active: active (running) since 五 2016-06-24 04:37:37 CST; 35min ago\n Main PID: 2888 (mysqld)\n   CGroup: /system.slice/mysqld.service\n           └─2888 /usr/sbin/mysqld --daemonize --pid-file=/var/run/mysqld/mysqld.pid\n\n6月 24 04:37:36 localhost.localdomain systemd[1]: Starting MySQL Server...\n6月 24 04:37:37 localhost.localdomain systemd[1]: Started MySQL Server.</code></pre>\n</div>\n</div>\n</div>\n</div>\n<div class=\"sect1\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<h2 id=\"_4_开机启动\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">4. 开机启动</h2>\n<div class=\"sectionbody\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<div class=\"listingblock\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<div class=\"content\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<pre class=\"highlight\"><code class=\"language-shell\" data-lang=\"shell\">shell&gt; systemctl enable mysqld\nshell&gt; systemctl daemon-reload</code></pre>\n</div>\n</div>\n</div>\n</div>\n<div class=\"sect1\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<h2 id=\"_5_修改root本地登录密码\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">5. 修改root本地登录密码</h2>\n<div class=\"sectionbody\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<div class=\"paragraph\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<p>mysql安装完成之后，在/var/log/mysqld.log文件中给root生成了一个默认密码。通过下面的方式找到root默认密码，然后登录mysql进行修改：</p>\n</div>\n<div class=\"listingblock\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<div class=\"content\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<pre class=\"highlight\"><code class=\"language-shell\" data-lang=\"shell\">shell&gt; grep 'temporary password' /var/log/mysqld.log</code></pre>\n</div>\n</div>\n<div class=\"imageblock\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<div class=\"content\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<img src=\"https://resources.echocow.cn/image/blog/centos/1.4.png\" alt=\"4\">\n</div>\n</div>\n<div class=\"listingblock\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<div class=\"content\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<pre class=\"highlight\"><code class=\"language-shell\" data-lang=\"shell\">shell&gt; mysql -uroot -p\nmysql&gt; ALTER USER 'root'@'localhost' IDENTIFIED BY 'MyNewPass4!';</code></pre>\n</div>\n</div>\n<div class=\"paragraph\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<p>或者</p>\n</div>\n<div class=\"listingblock\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<div class=\"content\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<pre class=\"highlight\"><code class=\"language-shell\" data-lang=\"shell\">mysql&gt; set password for 'root'@'localhost'=password('MyNewPass4!');</code></pre>\n</div>\n</div>\n<div class=\"paragraph\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<p>注意：mysql5.7默认安装了密码安全检查插件（validate_password），默认密码检查策略要求密码必须包含：大小写字母、数字和特殊符号，并且长度不能少于8位。否则会提示ERROR\n1819 (HY000): Your password does not satisfy the current policy\nrequirements错误，如下图所示：</p>\n</div>\n<div class=\"imageblock\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<div class=\"content\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<img src=\"https://resources.echocow.cn/image/blog/centos/1.5.png\" alt=\"5\">\n</div>\n</div>\n<div class=\"paragraph\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<p>通过msyql环境变量可以查看密码策略的相关信息：</p>\n</div>\n<div class=\"listingblock\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<div class=\"content\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<pre class=\"highlight\"><code class=\"language-shell\" data-lang=\"shell\">mysql&gt; show variables like '%password%';</code></pre>\n</div>\n</div>\n<div class=\"imageblock\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<div class=\"content\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<img src=\"https://resources.echocow.cn/image/blog/centos/1.6.png\" alt=\"6\">\n</div>\n</div>\n<div class=\"listingblock\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<div class=\"content\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<pre class=\"highlight\"><code class=\"language-shell\" data-lang=\"shell\">validate_password_policy：密码策略，默认为MEDIUM策略\nvalidate_password_dictionary_file：密码策略文件，策略为STRONG才需要\nvalidate_password_length：密码最少长度\nvalidate_password_mixed_case_count：大小写字符长度，至少1个\nvalidate_password_number_count ：数字至少1个\nvalidate_password_special_char_count：特殊字符至少1个</code></pre>\n</div>\n</div>\n<div class=\"paragraph\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<p>上述参数是默认策略MEDIUM的密码检查规则。</p>\n</div>\n<div class=\"paragraph\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<p>共有以下几种密码策略：</p>\n</div>\n<table class=\"tableblock frame-all grid-all stretch\">\n<colgroup>\n<col style=\"width: 46%;\">\n<col style=\"width: 54%;\">\n</colgroup>\n<thead>\n<tr>\n<th class=\"tableblock halign-left valign-top\">策略</th>\n<th class=\"tableblock halign-left valign-top\">检查规则</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">0 or LOW</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">Length</p></td>\n</tr>\n<tr>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">1 or MEDIUM</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">Length; numeric, lowercase/uppercase, and special\ncharacters</p></td>\n</tr>\n<tr>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">2 or STRONG</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">Length; numeric, lowercase/uppercase, and special\ncharacters; dictionary file</p></td>\n</tr>\n</tbody>\n</table>\n<div class=\"paragraph\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<p>MySQL官网密码策略详细说明：http://dev.mysql.com/doc/refman/5.7/en/validate-password-options-variables.html#sysvar_validate_password_policy</p>\n</div>\n</div>\n</div>\n<div class=\"sect1\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<h2 id=\"_6_修改密码策略\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">6. 修改密码策略</h2>\n<div class=\"sectionbody\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<div class=\"paragraph\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<p>在/etc/my.cnf文件添加validate_password_policy配置，指定密码策略</p>\n</div>\n<div class=\"listingblock\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<div class=\"content\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<pre class=\"highlight\"><code class=\"language-shell\" data-lang=\"shell\"># 选择0（LOW），1（MEDIUM），2（STRONG）其中一种，选择2需要提供密码字典文件\nvalidate_password_policy=0\n# 如果不需要密码策略，添加my.cnf文件中添加如下配置禁用即可：\nvalidate_password = off\n# 重新启动mysql服务使配置生效：\nsystemctl restart mysqld</code></pre>\n</div>\n</div>\n<div class=\"sect2\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<h3 id=\"_7_添加远程登录用户\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">7. 添加远程登录用户</h3>\n<div class=\"paragraph\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<p>默认只允许root帐户在本地登录，如果要在其它机器上连接mysql，必须修改root允许远程连接，或者添加一个允许远程连接的帐户，为了安全起见，我添加一个新的帐户：</p>\n</div>\n<div class=\"listingblock\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<div class=\"content\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<pre class=\"highlight\"><code class=\"language-shell\" data-lang=\"shell\">mysql&gt; GRANT ALL PRIVILEGES ON *.* TO 'echocow'@'%' IDENTIFIED BY 'Yangxin0917!' WITH GRANT OPTION;</code></pre>\n</div>\n</div>\n</div>\n<div class=\"sect2\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<h3 id=\"_8_配置默认编码为utf8\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">8. 配置默认编码为utf8</h3>\n<div class=\"paragraph\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<p>修改/etc/my.cnf配置文件，在[mysqld]下添加编码配置，如下所示：</p>\n</div>\n<div class=\"listingblock\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<div class=\"content\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<pre class=\"highlight\"><code class=\"language-shell\" data-lang=\"shell\">[mysqld]\ncharacter_set_server=utf8\ninit_connect='SET NAMES utf8'</code></pre>\n</div>\n</div>\n<div class=\"paragraph\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<p>重新启动mysql服务，查看数据库默认编码如下所示：</p>\n</div>\n<div class=\"imageblock\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<div class=\"content\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<img src=\"https://resources.echocow.cn/image/blog/centos/1.7.png\" alt=\"6\">\n</div>\n</div>\n<div class=\"quoteblock\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<blockquote>\n<div class=\"paragraph\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<p>默认配置文件路径： - 配置文件：/etc/my.cnf -\n日志文件：/var/log//var/log/mysqld.log -\n服务启动脚本：/usr/lib/systemd/system/mysqld.service -\nsocket文件：/var/run/mysqld/mysqld.pid</p>\n</div>\n</blockquote>\n</div>\n</div>\n</div>\n</div>","document":{"title":"[归档] CentOS7 64位下 MySQL5.7 安装与配置（YUM）"},"pageAttributes":{"category":"归档","description":"CentOS7 64位下 MySQL5.7 安装与配置（YUM）","image":"https://img.hacpai.com/bing/20180113.jpg?imageView2/1/w/1280/h/720/interlace/1/q/100","sort":null}}},"pageContext":{"slug":"/articles/2018/02/02/1546344583722.html","next":{"document":{"title":"[归档] 02-03 hibernate 5.2 以后  criteria 过时 的 替换"},"fields":{"slug":"/articles/2018/02/09/1546344579701.html"}},"previous":{"document":{"title":"[归档] CentOS7 上安装 JDK1.8"},"fields":{"slug":"/articles/2018/02/02/1546344578809.html"}}}},"staticQueryHashes":["3069561552","3673333084"]}