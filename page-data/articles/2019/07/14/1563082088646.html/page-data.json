{"componentChunkName":"component---src-templates-post-tsx","path":"/articles/2019/07/14/1563082088646.html","result":{"data":{"asciidoc":{"id":"4da6c0e4-868a-50e8-8940-4f1681532ee7","fields":{"slug":"/articles/2019/07/14/1563082088646.html","birthTime":"2019-07-14T05:28:08.733Z","modifiedTime":"2020-01-20T07:03:55.576Z"},"html":"<div id=\"toc\" class=\"toc\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<div id=\"toctitle\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">Table of Contents</div>\n<ul class=\"sectlevel1\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<li data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\"><a href=\"#_系列文章\">系列文章</a></li>\n<li data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\"><a href=\"#_预备知识\">预备知识</a></li>\n<li data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\"><a href=\"#_oauth2\">Oauth2</a>\n<ul class=\"sectlevel2\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<li data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\"><a href=\"#_传统应用\">传统应用</a></li>\n<li data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\"><a href=\"#_现在的应用\">现在的应用</a></li>\n<li data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\"><a href=\"#_角色\">角色</a></li>\n<li data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\"><a href=\"#_四种授权模式\">四种授权模式</a></li>\n<li data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\"><a href=\"#_客户端加密\">客户端加密</a></li>\n<li data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\"><a href=\"#_密码模式\">密码模式</a></li>\n<li data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\"><a href=\"#_安全考虑\">安全考虑</a></li>\n</ul>\n</li>\n<li data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\"><a href=\"#_技术选型\">技术选型</a></li>\n<li data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\"><a href=\"#_在这之前\">在这之前</a></li>\n</ul>\n</div>\n<div id=\"preamble\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<div class=\"sectionbody\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<div class=\"paragraph\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<p>很久没有写一篇长文章了，自己说起来其实年初换成 solo\n到现在，写的让自己满意的技术性文章也就只有\n<a href=\"https://echocow.cn/articles/2019/01/05/1546684795983.html\">spring boot\nrestful API 从零到一完整实践</a>\n这篇了，其他的其实都是只属于自己比较容易理解的笔记和记录而已。想想年中了，还是需要写上这么一篇实践性文章的。这段时间比较折磨自己的，莫过于就是\n<a href=\"https://spring.io/projects/spring-security-oauth\">spirng security oauth2</a>\n了，自己折腾了很久，也算是学会了一些吧，按照原来的方式，写了一篇文章。前面也写过\n<a href=\"https://echocow.cn/articles/2019/01/22/1548148450889.html\">spring boot\nsecurity oauth2 构建简单安全的 restful\napi</a>，但是太过于基础并且那时候自己也有很多不懂，现在实践了很多，有了更加深入的了解，记录一下顺便分享给大家。</p>\n</div>\n<div class=\"exampleblock\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<div class=\"content\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<div class=\"paragraph\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<p>GitHub 地址： <a href=\"https://github.com/lizhongyue248/spring-security-oauth2-demo\">spring-security-oauth2-demo</a></p>\n</div>\n<div class=\"paragraph\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<p>博客地址： <a href=\"https://echocow.cn\">echocow.cn</a></p>\n</div>\n</div>\n</div>\n</div>\n</div>\n<div class=\"sect1\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<h2 id=\"_系列文章\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">系列文章</h2>\n<div class=\"sectionbody\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<div class=\"olist arabic\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<ol class=\"arabic\">\n<li data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<p>较为详细的学习 oauth2 的四种模式其中的两种授权模式</p>\n</li>\n<li data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<p><a href=\"https://echocow.cn/articles/2019/07/14/1563082247386.html\">spring boot\noauth2 自动配置实现</a></p>\n</li>\n<li data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<p><a href=\"https://echocow.cn/articles/2019/07/14/1563096109754.html\">spring\nsecurity oauth2 授权服务器配置</a></p>\n</li>\n<li data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<p><a href=\"https://echocow.cn/articles/2019/07/20/1563611848587.html\">spring\nsecurity oauth2 资源服务器配置</a></p>\n</li>\n<li data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<p><a href=\"https://echocow.cn/articles/2019/07/30/1564498598952.html\">spring\nsecurity oauth2 自定义授权模式（手机、邮箱等）</a></p>\n</li>\n<li data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<p><a href=\"https://echocow.cn/articles/2020/01/20/1579503807596.html\">spring\nsecurity oauth2 踩坑记录</a></p>\n</li>\n</ol>\n</div>\n<div class=\"paragraph\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<p>原本打算全部写完一起发的，但是才写到第三点，就已经上万字了，所以还是觉得分系列发吧～</p>\n</div>\n</div>\n</div>\n<div class=\"sect1\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<h2 id=\"_预备知识\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">预备知识</h2>\n<div class=\"sectionbody\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<div class=\"paragraph\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<p>具备以下基础知识能够方便你更好的阅读本篇文章</p>\n</div>\n<div class=\"ulist\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<ul data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<li data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<p>spring 基础</p>\n</li>\n<li data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<p>spring boot web 的使用与配置</p>\n</li>\n<li data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<p>spring security 的使用与配置</p>\n</li>\n<li data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<p>postman 的使用</p>\n</li>\n<li data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<p>idea、maven、lombok 的使用与配置</p>\n</li>\n</ul>\n</div>\n</div>\n</div>\n<div class=\"sect1\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<h2 id=\"_oauth2\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">Oauth2</h2>\n<div class=\"sectionbody\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<div class=\"paragraph\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<p>学习一项新的东西之前，我们要先了解一下他为我们解决了哪些事，能够带来什么样的便利，而在\nIT\n行业，了解一个东西最简单的方式就是去他的官网了解，所以我们先去官网了解一下这个协议：https://oauth.net/[Oauth2]</p>\n</div>\n<div class=\"exampleblock\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<div class=\"content\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<div class=\"paragraph\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<p>An <strong>open protocol</strong> to allow <strong>secure authorization</strong> in a <strong>simple</strong> and\n<strong>standard</strong> method from web, mobile and desktop applications.</p>\n</div>\n</div>\n</div>\n<div class=\"paragraph\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<p>一个允许从Web、移动和桌面应用程序简单和标准方法进行安全授权的开放协议。</p>\n</div>\n<div class=\"exampleblock\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<div class=\"content\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<div class=\"paragraph\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<p>The OAuth 2.0 authorization framework enables third-party applications\nto obtain <strong>limited</strong> access to a web service.</p>\n</div>\n</div>\n</div>\n<div class=\"paragraph\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<p>OAuth 2.0 授权框架使第三方应用程序能够获得对 Web 服务的有限访问权限。</p>\n</div>\n<div class=\"paragraph\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<p>从官网的解释就可以知道它可以完成如下两件事：</p>\n</div>\n<div class=\"olist arabic\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<ol class=\"arabic\">\n<li data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<p>对你的应用站点进行安全授权</p>\n</li>\n<li data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<p>使第三方应用程序能够获得对 Web 服务的有限访问权限</p>\n</li>\n</ol>\n</div>\n<div class=\"paragraph\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<p>我们这篇教程就是通过 spring security oauth2\n来完成这么两件事。我们来详细了解一下这个协议，首先了解什么要使用\noauth2。我们以 web 为例来进行了解。</p>\n</div>\n<div class=\"sect2\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<h3 id=\"_传统应用\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">传统应用</h3>\n<div class=\"paragraph\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<p>在我们传统的 web\n应用中，我们的前端页面和后端的逻辑都是一起部署的，大概流程如下：</p>\n</div>\n<div class=\"imageblock\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<div class=\"content\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<img src=\"https://resources.echocow.cn/file/2019/07/08/%E6%B7%B1%E5%BA%A6%E6%88%AA%E5%9B%BE_%E9%80%89%E6%8B%A9%E5%8C%BA%E5%9F%9F_20190708190354.png\" alt=\"传统模式\">\n</div>\n</div>\n<div class=\"paragraph\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<p>当我们发送一个请求的时候，直接先发给后端处理，后端处理完成后将数据发送给前端，然后前端渲染，再交给用户，所以有了模板引擎这个东西，例如\njsp、thymeleaf、freemarker\n这些，都是这样的流程。而这些个东西最为重要的就是\nsession，你可以通过存储在 session\n里面的东西对他进行授权/认证等操作，大概如下：</p>\n</div>\n<div class=\"imageblock\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<div class=\"content\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<img src=\"https://resources.echocow.cn/file/2019/07/08/%E6%B7%B1%E5%BA%A6%E6%88%AA%E5%9B%BE_%E9%80%89%E6%8B%A9%E5%8C%BA%E5%9F%9F_20190708194101.png\" alt=\"授权\">\n</div>\n</div>\n</div>\n<div class=\"sect2\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<h3 id=\"_现在的应用\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">现在的应用</h3>\n<div class=\"paragraph\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<p>那么现在我们的应用是什么样的呢？现在的前端已经不再是只有\nhtml、css、javascript 了，也不再是 bootstrap 的天下，也没有 jquery\n一出，万人空巷了。前端项目组建工程化，已经能够完整的独立成为一个工程化的项目了。所以我们现在前后端是完全分离的，<strong>前后端各司其职，前端完成前端的事，只做页面，后端完成后端的事，只做逻辑和数据库操作，完全两个独立的引用，通过接口进行交互</strong>，那么我们的大概流程如下：</p>\n</div>\n<div class=\"imageblock\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<div class=\"content\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<img src=\"https://resources.echocow.cn/file/2019/07/08/%E6%B7%B1%E5%BA%A6%E6%88%AA%E5%9B%BE_%E9%80%89%E6%8B%A9%E5%8C%BA%E5%9F%9F_20190708191537.png\" alt=\"前后端分离\">\n</div>\n</div>\n<div class=\"paragraph\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<p>用户通过浏览器请求前端应用的页面，然后页面里面加载请求到数据，再渲染页面。那么现在的授权没有\nsession\n了，前后端是完全独立的两个项目了，我们要怎么进行认证授权呢？对于一个受保护的应用来说，他的请求流程如下：</p>\n</div>\n<div class=\"imageblock\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<div class=\"content\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<img src=\"https://resources.echocow.cn/file/2019/07/08/%E6%B7%B1%E5%BA%A6%E6%88%AA%E5%9B%BE_%E9%80%89%E6%8B%A9%E5%8C%BA%E5%9F%9F_20190708203251.png\" alt=\"现在\">\n</div>\n</div>\n<div class=\"paragraph\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<p>在这个流程中，我们后端应用其实变成了两个，一个是授权服务器一个是资源服务器，<strong>当然你完全可以简爱嗯他们两个同时写在一个之中</strong>。单独提出来的好处是什么呢？最主要的一点就是上面提到的\n<strong>使第三方应用程序能够获得对 Web\n服务的有限访问权限</strong>，简单的说就是能够更加方便的另外一个应用接入。当你写好一个授权服务器以后，其他应用就可以共用这个授权服务器，他们就作为资源服务器亦或是客户端即可。</p>\n</div>\n</div>\n<div class=\"sect2\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<h3 id=\"_角色\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">角色</h3>\n<div class=\"paragraph\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<p>在这个协议中，我们需要明确一个 <strong>角色</strong>\n的概念，在前面的和传统应用的对比中，我们提到了资源服务器和授权服务器，这就是其中两个角色，在\nOauth2 中，总共有四种角色：</p>\n</div>\n<table class=\"tableblock frame-all grid-all stretch\">\n<colgroup>\n<col style=\"width: 12%;\">\n<col style=\"width: 19%;\">\n<col style=\"width: 58%;\">\n<col style=\"width: 11%;\">\n</colgroup>\n<thead>\n<tr>\n<th class=\"tableblock halign-left valign-top\">名称</th>\n<th class=\"tableblock halign-left valign-top\">英文名</th>\n<th class=\"tableblock halign-left valign-top\">描述</th>\n<th class=\"tableblock halign-left valign-top\">web例子</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">资源所有者</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">resource owner</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">能够授予对受保护资源的访问权的实体。当资源所有者是一个人时，它就是用户。</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">用户</p></td>\n</tr>\n<tr>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">资源服务器</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">resource server</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">承载受保护资源的服务器，能够使用访问令牌接受和响应受保护资源请求。</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">后端资源数据</p></td>\n</tr>\n<tr>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">客户端</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">client</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">代表资源所有者及其授权发出受保护资源请求的应用程序。``客户端''\n并不意味着任何特定的实现特征(例如，应用程序是否在服务器、桌面或其他设备上执行)。</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">前端应用</p></td>\n</tr>\n<tr>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">授权服务器</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">authorization server</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">在成功认证资源所有者并获得授权后，服务器向客户端发出访问令牌。</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">后端授权</p></td>\n</tr>\n</tbody>\n</table>\n<div class=\"paragraph\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<p>而授权服务器可以是与资源服务器<strong>相同的服务器</strong>或<strong>单独的服务器</strong>。\n单个授权服务器可以发出由<strong>多个资源服务器接受的访问令牌</strong>。</p>\n</div>\n<div class=\"paragraph\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<p>流程图大概如下：</p>\n</div>\n<div class=\"listingblock\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<div class=\"content\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<pre class=\"highlight\"><code class=\"language-none\" data-lang=\"none\">     +--------+                               +-----------------+\n     |        |--（A）------- 授权请求 --------&gt;|                 |\n     |        |                               | 资源所有者（用户） |\n     |        |&lt;-（B）------- 授权许可 ---------|                 |\n     |        |                               +-----------------+\n     |        |\n     |        |                               +-----------------+\n     |        |--（C）------- 授权许可 --------&gt;|                 |\n     | 客户端  |                               |  授权服务器（1    |\n     |        |&lt;-（D）----- Access Token ----）|                 |\n     |        |                               +-----------------+\n     |        |\n     |        |                               +-----------------+\n     |        |（-（E）---- Access Token -----&gt;|                 |\n     |        |                               |   资源服务器（2   |\n     |        |&lt;-（F）---- 获取受保护的资源 -----|                 |\n     +--------+                               +-----------------+</code></pre>\n</div>\n</div>\n<div class=\"paragraph\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<p>图中所示的 抽象 OAuth 2.0 流程描述了四个角色之间的交互，包括以下步骤：</p>\n</div>\n<div class=\"paragraph\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<p>（A）客户机请求资源所有者（用户）的授权。授权请求可以直接发送给资源所有者(如图所示)，最好通过作为中介的授权服务器间接发送。<strong>简单地说，用户点击登录，会转到登录页面显示给用户。</strong></p>\n</div>\n<div class=\"paragraph\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<p>（B）客户端接收授权许可，这是表示资源所有者授权的凭据，使用 Oauth2\n规范中定义的四种授权类型之一或使用扩展授权类型表示。授权授予类型取决于客户机用于请求授权的方法和授权服务器支持的类型。<strong>简单地说，选择\noauth2 中四种授权模式进行授权。</strong></p>\n</div>\n<div class=\"paragraph\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<p>（C）客户端通过向授权服务器进行认证并呈现授权授权来请求访问令牌。<strong>简单地说，客户端会向授权服务器使用前面选择的四种方式之一请求认证。</strong></p>\n</div>\n<div class=\"paragraph\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<p>（D）授权服务器对客户端进行身份验证并验证授权授予，如果有效，则发出访问令牌。<strong>简单地说，授权成功发放令牌。</strong></p>\n</div>\n<div class=\"paragraph\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<p>（E）客户端从资源服务器请求受保护的资源，并通过呈现访问令牌进行身份验证。<strong>简单地说，携带\n令牌 请求资源服务器。</strong></p>\n</div>\n<div class=\"paragraph\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<p>（F）资源服务器验证访问令牌，如果有效，则为请求服务。<strong>简单地说，如果令牌有效，就允许访问资源。</strong></p>\n</div>\n<div class=\"paragraph\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<p>（1）授权服务器可以只有一台，一台授权可以发放多个资源服务器。</p>\n</div>\n<div class=\"paragraph\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<p>（2）资源服务器需要关联一台授权服务器作为资源的保护和认证。</p>\n</div>\n<div class=\"paragraph\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<p>最为重要的部分为 B 中的\n授权许可，它是代表资源所有者的授权（访问其受保护的资源）的<strong>凭据</strong>，客户端使用该授权来获得访问令牌。该规范定义了四种授权类型——<strong>授权代码、隐式、资源所有者密码凭证和客户端凭证</strong>——以及用于定义其他类型的可扩展性机制（自定义授权）。</p>\n</div>\n</div>\n<div class=\"sect2\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<h3 id=\"_四种授权模式\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">四种授权模式</h3>\n<div class=\"paragraph\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<p>客户端必须得到用户的授权（authorization grant），才能获得令牌（access\ntoken）。OAuth 2.0定义了四种授权方式如下：</p>\n</div>\n<div class=\"ulist\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<ul data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<li data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<p>授权码模式（authorization code）</p>\n</li>\n<li data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<p>密码模式（resource owner password credentials）</p>\n</li>\n<li data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<p>简化模式（implicit）</p>\n</li>\n<li data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<p>客户端模式（client credentials）</p>\n</li>\n<li data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<p>扩展模式（extension）</p>\n</li>\n</ul>\n</div>\n<div class=\"paragraph\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<p>最为常用的为第一、二种，我们这篇文章也只会完成第一二种，四种具体请参考\n<a href=\"http://www.ruanyifeng.com/blog/2014/05/oauth_2_0.html\">阮一峰 理解OAuth\n2.0</a> ，请注意详细看文章的 <strong>名词定义</strong>\n模块。阮一峰老师的文章已经写的很清楚了，但是我依旧还是需要指明一下我们即将开始的第一二种的\napi 设计。</p>\n</div>\n<div class=\"quoteblock\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<blockquote>\n<div class=\"paragraph\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<p><strong>注意：以下 api 设计为 spring security 提供实现，并不是 oauth2 的标准\napi 实现</strong></p>\n</div>\n</blockquote>\n</div>\n<div class=\"paragraph\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<p>不过在那之前，我们先来了解一下 <strong>客户端的加密</strong></p>\n</div>\n</div>\n<div class=\"sect2\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<h3 id=\"_客户端加密\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">客户端加密</h3>\n<div class=\"paragraph\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<p>在 spring security oauth\n中，推荐加密我们的客户端信息，客户端和授权服务器建立适合授权服务器安全要求的客户端认证方法。授权服务器可以接受满足其安全要求的任何形式的客户端身份验证。一般来说我们使用的是\n<strong>密码验证</strong> 的方式加密我们的客户端信息。</p>\n</div>\n<div class=\"paragraph\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<p>推荐的方式是使用 HTTP Basic\n，我们需要设置以下参数，当设置成功以后将客户端凭证加密存放在请求头中去请求授权信息，参数如下：</p>\n</div>\n<table class=\"tableblock frame-all grid-all stretch\">\n<colgroup>\n<col style=\"width: 33.3333%;\">\n<col style=\"width: 33.3333%;\">\n<col style=\"width: 33.3334%;\">\n</colgroup>\n<thead>\n<tr>\n<th class=\"tableblock halign-left valign-top\">参数名称</th>\n<th class=\"tableblock halign-left valign-top\">是否必填</th>\n<th class=\"tableblock halign-left valign-top\">描述</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">client_id</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">REQUIRED</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">客户端 id</p></td>\n</tr>\n<tr>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">client_secret</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">REQUIRED</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">客户端密码，如果客户机secret是空字符串，则客户机可以省略该参数</p></td>\n</tr>\n</tbody>\n</table>\n<div class=\"paragraph\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<p>当我们请求的时候，需要设置相应的客户端认证信息，并存放在请求头中，设置方法如下：</p>\n</div>\n<div class=\"listingblock\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<div class=\"content\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<pre class=\"highlight\"><code class=\"language-markup\" data-lang=\"markup\"> Authorization: Basic client_id：client_secret base64编码\n eg:\n client_id:web\n client_secret:secret\n 加密“web:secret” 得到 “QmFzaWMgd2ViOnNlY3JldA==”\n 授权请求头中需要携带如下键值对：\n Authorization: Basic QmFzaWMgd2ViOnNlY3JldA==</code></pre>\n</div>\n</div>\n<div class=\"paragraph\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<p>这是保证客户端安全十分重要的一环，强烈推荐对客户端进行加密！</p>\n</div>\n<div class=\"sect3\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<h4 id=\"_授权码模式\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">授权码模式</h4>\n<div class=\"paragraph\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<p>他是一种流程最为严密，安全性最高的授权模式，主要为以下几个步骤：</p>\n</div>\n<div class=\"admonitionblock important\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<table>\n<tbody><tr>\n<td class=\"icon\">\n<i class=\"fa icon-important\" title=\"Important\"></i>\n</td>\n<td class=\"content\">\n注意：以下所有请求都必须在请求头中携带上一点中的客户端加密信息！\n</td>\n</tr>\n</tbody></table>\n</div>\n<div class=\"olist arabic\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<ol class=\"arabic\">\n<li data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<p>用户进入应用，携带一个 <em>重定向应用地址</em> 到 <strong>授权服务器</strong>\n进行登录，在登录成功并且用户同意授权以后，授权服务携带一个生成的\n<strong>授权码</strong> 重定向到指定的 <em>重定向应用地址</em> 。</p>\n</li>\n<li data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<p>应用携带接收到的 <strong>授权码</strong> 再次去请求\n<strong>授权服务器</strong>，在验证成功后，验证服务器下发 token。</p>\n</li>\n</ol>\n</div>\n<div class=\"paragraph\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<p>所以需要两个请求，在 spring security oauth2 中，api 如下，我们将这些 api\n称为 <em>端点</em>：</p>\n</div>\n</div>\n<div class=\"sect3\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<h4 id=\"_授权端点\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">授权端点</h4>\n<div class=\"ulist\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<ul data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<li data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<p>/oauth/authorize：授权端点，通过此端点跳转到 <strong>授权服务器</strong>\n进行认证，完成第一个请求。携带如下参数：</p>\n</li>\n</ul>\n</div>\n<table class=\"tableblock frame-all grid-all stretch\">\n<colgroup>\n<col style=\"width: 15%;\">\n<col style=\"width: 15%;\">\n<col style=\"width: 70%;\">\n</colgroup>\n<thead>\n<tr>\n<th class=\"tableblock halign-left valign-top\">参数名称</th>\n<th class=\"tableblock halign-left valign-top\">是否必填</th>\n<th class=\"tableblock halign-left valign-top\">描述</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">response_type</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">REQUIRED</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">必须为 code</p></td>\n</tr>\n<tr>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">client_id</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">REQUIRED</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">客户端的 id</p></td>\n</tr>\n<tr>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">redirect_uri</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">OPTIONAL</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">获取授权码后重定向地址</p></td>\n</tr>\n<tr>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">scope</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">OPTIONAL</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">申请的权限范围</p></td>\n</tr>\n<tr>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">state</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">RECOMMENDED</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">客户端的当前状态，可以指定任意值，认证服务器会原封不动地返回这个值，推荐。</p></td>\n</tr>\n</tbody>\n</table>\n<div class=\"paragraph\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<p>授权成功的情况，会携带以下两个参数重定向到到 <strong>redirect_uri</strong> 中：</p>\n</div>\n<table class=\"tableblock frame-all grid-all stretch\">\n<colgroup>\n<col style=\"width: 15%;\">\n<col style=\"width: 15%;\">\n<col style=\"width: 70%;\">\n</colgroup>\n<thead>\n<tr>\n<th class=\"tableblock halign-left valign-top\">参数名称</th>\n<th class=\"tableblock halign-left valign-top\">是否必有</th>\n<th class=\"tableblock halign-left valign-top\">描述</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">code</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">REQUIRED</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">授权服务器生成的授权代码。授权代码必须在发布后不久过期，以降低泄漏的风险。最大授权代码生命周期为10分钟</p></td>\n</tr>\n<tr>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">state</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">REQUIRED</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">如果上一步中提供 <code>state</code>\n参数，会原封不动地返回这个值。</p></td>\n</tr>\n</tbody>\n</table>\n<div class=\"quoteblock\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<blockquote>\n<div class=\"paragraph\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<p>注意：官网中给出的解释 code 有 RECOMMENDED\n推荐的情况，但是我没找到如何使用，所以没写。</p>\n</div>\n</blockquote>\n</div>\n<div class=\"paragraph\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<p>授权失败的情况分为两种</p>\n</div>\n<div class=\"olist arabic\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<ol class=\"arabic\">\n<li data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<p>如果请求由于重定向URI丢失、无效或不匹配而失败，或者如果客户端标识符丢失或无效，授权服务器应通知资源所有者错误，并且<strong>不得自动将用户代理重定向到无效的重定向URI</strong>。</p>\n</li>\n<li data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<p>如果资源所有者拒绝访问请求，或者如果请求由于除了丢失或无效重定向URI以外的原因而失败，则授权服务器通过使用\n<code>application/x-www-form-urlencoded</code> 格式<strong>向重定向 URI\n的查询组件添加以下参数来通知客户端</strong>，参数如下：(对于 spring\n，目前没有遇到 error_uri 属性)</p>\n</li>\n</ol>\n</div>\n<table class=\"tableblock frame-all grid-all stretch\">\n<colgroup>\n<col style=\"width: 17%;\">\n<col style=\"width: 7%;\">\n<col style=\"width: 22%;\">\n<col style=\"width: 54%;\">\n</colgroup>\n<thead>\n<tr>\n<th class=\"tableblock halign-left valign-top\">参数名称</th>\n<th class=\"tableblock halign-left valign-top\">是否必有</th>\n<th class=\"tableblock halign-left valign-top\">值</th>\n<th class=\"tableblock halign-left valign-top\">描述</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">error</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">REQUIRED</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">invalid_request</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">请求缺少必需的参数，包括无效的参数值，不止一次地包含参数，或者存在其他形式的异常。</p></td>\n</tr>\n<tr>\n<td class=\"tableblock halign-left valign-top\"></td>\n<td class=\"tableblock halign-left valign-top\"></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">unauthorized_client</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">未授权客户端使用此方法请求授权代码。</p></td>\n</tr>\n<tr>\n<td class=\"tableblock halign-left valign-top\"></td>\n<td class=\"tableblock halign-left valign-top\"></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">access_denied</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">资源所有者或授权服务器拒绝了该请求。</p></td>\n</tr>\n<tr>\n<td class=\"tableblock halign-left valign-top\"></td>\n<td class=\"tableblock halign-left valign-top\"></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">unsupported_response_type</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">授权服务器不支持使用此方法获取授权代码。</p></td>\n</tr>\n<tr>\n<td class=\"tableblock halign-left valign-top\"></td>\n<td class=\"tableblock halign-left valign-top\"></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">invalid_scope</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">请求的作用域无效、未知或格式不正确。</p></td>\n</tr>\n<tr>\n<td class=\"tableblock halign-left valign-top\"></td>\n<td class=\"tableblock halign-left valign-top\"></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">server_error</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">授权服务器遇到意外情况，无法满足请求。(此错误代码是必需的，因为500内部服务器错误HTTP状态代码不能通过HTTP重定向返回给客户端。)</p></td>\n</tr>\n<tr>\n<td class=\"tableblock halign-left valign-top\"></td>\n<td class=\"tableblock halign-left valign-top\"></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">temporarily_unavailable</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">由于服务器暂时过载或维护，授权服务器当前无法处理该请求。(此错误代码是必需的，因为503服务不可用的HTTP状态代码不能通过HTTP重定向返回给客户端。)</p></td>\n</tr>\n<tr>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">error_description</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">OPTIONAL</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">-</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">提供附加信息的人类可读ASCII\n[USASCII]文本，用于帮助客户端开发人员理解所发生的错误。</p></td>\n</tr>\n<tr>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">error_uri</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">OPTIONAL</p></td>\n<td class=\"tableblock halign-left valign-top\"></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">一种带有错误信息的可读网页的URI标识，用于向客户端开发人员提供有关错误的附加信息。</p></td>\n</tr>\n</tbody>\n</table>\n</div>\n<div class=\"sect3\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<h4 id=\"_令牌端点\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">令牌端点</h4>\n<div class=\"ulist\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<ul data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<li data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<p>/oauth/token：令牌端点，通过上一步获取到的 <strong>授权码</strong>\n验证与生成令牌，完成第二个请求，携带如下参数：</p>\n</li>\n</ul>\n</div>\n<table class=\"tableblock frame-all grid-all stretch\">\n<colgroup>\n<col style=\"width: 33.3333%;\">\n<col style=\"width: 33.3333%;\">\n<col style=\"width: 33.3334%;\">\n</colgroup>\n<thead>\n<tr>\n<th class=\"tableblock halign-left valign-top\">参数名称</th>\n<th class=\"tableblock halign-left valign-top\">是否必填</th>\n<th class=\"tableblock halign-left valign-top\">描述</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">grant_type</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">REQUIRED</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">使用的授权模式，值固定为``authorization_code''</p></td>\n</tr>\n<tr>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">code</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">REQUIRED</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">上一步获得的授权码</p></td>\n</tr>\n<tr>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">redirect_uri</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">REQUIRED</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">重定向URI，必须与上一步中的该参数值保持一致</p></td>\n</tr>\n<tr>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">client_id</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">REQUIRED</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">客户端的 id</p></td>\n</tr>\n<tr>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">scope</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">RECOMMENDED</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">授权范围，必须与第一步相同</p></td>\n</tr>\n</tbody>\n</table>\n<div class=\"paragraph\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<p>如果访问令牌请求有效且经过授权，授权服务器将发出访问令牌和可选的刷新令牌，可以得到如下响应参数：</p>\n</div>\n<table class=\"tableblock frame-all grid-all stretch\">\n<colgroup>\n<col style=\"width: 25%;\">\n<col style=\"width: 25%;\">\n<col style=\"width: 25%;\">\n<col style=\"width: 25%;\">\n</colgroup>\n<thead>\n<tr>\n<th class=\"tableblock halign-left valign-top\">参数名称</th>\n<th class=\"tableblock halign-left valign-top\">是否必有</th>\n<th class=\"tableblock halign-left valign-top\">描述</th>\n<th class=\"tableblock halign-left valign-top\">是否有实现</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">access_token</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">REQUIRED</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">授权服务器颁发的访问令牌</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">是</p></td>\n</tr>\n<tr>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">token_type</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">REQUIRED</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">令牌类型，该值大小写不敏感，可以是bearer类型或mac类型</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">是</p></td>\n</tr>\n<tr>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">expires_in</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">RECOMMENDED</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">过期时间，单位为秒</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">是</p></td>\n</tr>\n<tr>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">refresh_token</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">OPTIONAL</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">表示更新令牌，用来获取下一次的访问令牌</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">是，需要设置</p></td>\n</tr>\n<tr>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">scope</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">OPTIONAL</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">权限范围，如果有，则与客户端申请的范围一致</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">是</p></td>\n</tr>\n</tbody>\n</table>\n<div class=\"paragraph\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<p>如果请求客户端身份验证失败或无效，授权服务器将返回错误响应，授权服务器使用HTTP\n400（错误请求）状态代码进行响应（除非另有说明），并在响应中包含以下参数：</p>\n</div>\n<table class=\"tableblock frame-all grid-all\" style=\"width: 99%;\">\n<colgroup>\n<col style=\"width: 17%;\">\n<col style=\"width: 7%;\">\n<col style=\"width: 20%;\">\n<col style=\"width: 56%;\">\n</colgroup>\n<thead>\n<tr>\n<th class=\"tableblock halign-left valign-top\">参数名称</th>\n<th class=\"tableblock halign-left valign-top\">是否必有</th>\n<th class=\"tableblock halign-left valign-top\">值</th>\n<th class=\"tableblock halign-left valign-top\">描述</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">error</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">REQUIRED</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">invalid_request</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">请求缺少必需的参数，包含不受支持的参数值(授权类型除外)，重复参数，包含多个凭据，使用多个机制来验证客户端，或者格式不正确。</p></td>\n</tr>\n<tr>\n<td class=\"tableblock halign-left valign-top\"></td>\n<td class=\"tableblock halign-left valign-top\"></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">invalid_client</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">客户端身份验证失败(例如，未知客户端、不包含客户端身份验证或不支持的身份验证方法)。授权服务器可以返回一个超文本传输协议401(未授权)状态码，以指示支持哪些超文本传输协议认证方案。如果客户端试图通过<code>授权''请求头字段进行身份验证，授权服务器必须用一个HTTP401(未授权)状态代码进行响应，并包括与客户端使用的身份验证方案相匹配的</code>WWW-Authenticate''响应头字段。</p></td>\n</tr>\n<tr>\n<td class=\"tableblock halign-left valign-top\"></td>\n<td class=\"tableblock halign-left valign-top\"></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">invalid_grant</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">所提供的授权授予(例如，授权代码、资源所有者凭证)或刷新令牌无效、过期、已撤销、不匹配授权请求中使用的重定向URI，或已向其他客户机发出。</p></td>\n</tr>\n<tr>\n<td class=\"tableblock halign-left valign-top\"></td>\n<td class=\"tableblock halign-left valign-top\"></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">unauthorized_client</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">经过身份验证的客户端无权使用此授权授权类型。</p></td>\n</tr>\n<tr>\n<td class=\"tableblock halign-left valign-top\"></td>\n<td class=\"tableblock halign-left valign-top\"></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">unsupported_grant_type</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">授权服务器不支持授权授权类型。</p></td>\n</tr>\n<tr>\n<td class=\"tableblock halign-left valign-top\"></td>\n<td class=\"tableblock halign-left valign-top\"></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">invalid_scope</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">请求的范围无效、未知、格式错误或超出了资源所有者授予的范围。</p></td>\n</tr>\n<tr>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">error_description</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">OPTIONAL</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">-</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">提供附加信息的人类可读ASCII\n[USASCII]文本，用于帮助客户端开发人员理解所发生的错误。</p></td>\n</tr>\n<tr>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">error_uri</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">OPTIONAL</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">-</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">一种带有错误信息的可读网页的URI标识，用于向客户端开发人员提供有关错误的附加信息。</p></td>\n</tr>\n</tbody>\n</table>\n</div>\n</div>\n<div class=\"sect2\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<h3 id=\"_密码模式\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">密码模式</h3>\n<div class=\"paragraph\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<p>这种模式可以理解成我们普通应用的用户名密码登录，在第三方接入的时候不建议使用这种模式，但是如果是自己的应用，那么这种模式是最为简单方便快捷的了。步骤只有一个：</p>\n</div>\n<div class=\"admonitionblock important\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<table>\n<tbody><tr>\n<td class=\"icon\">\n<i class=\"fa icon-important\" title=\"Important\"></i>\n</td>\n<td class=\"content\">\n注意：以下所有请求都必须在请求头中携带上面所说的客户端加密信息！\n</td>\n</tr>\n</tbody></table>\n</div>\n<div class=\"ulist\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<ul data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<li data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<p>用户携带用户名密码请求授权服务器，验证通过后下发令牌</p>\n</li>\n</ul>\n</div>\n<div class=\"paragraph\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<p>他只需要一个请求，所以她只有一个令牌端点：</p>\n</div>\n<div class=\"sect3\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<h4 id=\"_令牌端点_2\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">令牌端点</h4>\n<div class=\"ulist\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<ul data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<li data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<p>/oauth/token：令牌端点，携带如下参数请求即可：</p>\n</li>\n</ul>\n</div>\n<table class=\"tableblock frame-all grid-all stretch\">\n<colgroup>\n<col style=\"width: 33.3333%;\">\n<col style=\"width: 33.3333%;\">\n<col style=\"width: 33.3334%;\">\n</colgroup>\n<thead>\n<tr>\n<th class=\"tableblock halign-left valign-top\">请求参数</th>\n<th class=\"tableblock halign-left valign-top\">是否必填</th>\n<th class=\"tableblock halign-left valign-top\">描述</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">grant_type</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">REQUIRED</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">使用的密码模式，值固定为``password''</p></td>\n</tr>\n<tr>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">username</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">REQUIRED</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">用户名</p></td>\n</tr>\n<tr>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">password</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">REQUIRED</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">密码</p></td>\n</tr>\n<tr>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">scope</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">OPTIONAL</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">请求权限范围</p></td>\n</tr>\n</tbody>\n</table>\n<div class=\"paragraph\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<p>请求成功和失败的响应同授权码模式。</p>\n</div>\n</div>\n</div>\n<div class=\"sect2\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<h3 id=\"_安全考虑\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">安全考虑</h3>\n<div class=\"admonitionblock important\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<table>\n<tbody><tr>\n<td class=\"icon\">\n<i class=\"fa icon-important\" title=\"Important\"></i>\n</td>\n<td class=\"content\">\n注意：以下所有请求都必须在请求头中携带上面所说的客户端加密信息！\n</td>\n</tr>\n</tbody></table>\n</div>\n<div class=\"paragraph\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<p>作为一个灵活且可扩展的框架，OAuth 的安全考虑取决于许多因素。spring\nsecurity oauth 为我们提供了一些默认的端点如下：</p>\n</div>\n<div class=\"ulist\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<ul data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<li data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<p>/oauth/authorize：授权端点</p>\n</li>\n<li data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<p>/oauth/token：令牌端点</p>\n</li>\n<li data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<p>/oauth/token：令牌端点也同时拥有刷新用户的功能，请求参数如下：</p>\n</li>\n</ul>\n</div>\n<table class=\"tableblock frame-all grid-all stretch\">\n<colgroup>\n<col style=\"width: 33.3333%;\">\n<col style=\"width: 33.3333%;\">\n<col style=\"width: 33.3334%;\">\n</colgroup>\n<thead>\n<tr>\n<th class=\"tableblock halign-left valign-top\">参数名称</th>\n<th class=\"tableblock halign-left valign-top\">是否必填</th>\n<th class=\"tableblock halign-left valign-top\">描述</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">grant_type</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">REQUIRED</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">固定值为``refresh_token''</p></td>\n</tr>\n<tr>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">refresh_token</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">REQUIRED</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">请求到 token 时传过来的 refresh_token</p></td>\n</tr>\n</tbody>\n</table>\n<div class=\"ulist\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<ul data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<li data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<p>/oauth/confirm_access：用户确认授权提交端点</p>\n</li>\n<li data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<p>/oauth/error：授权服务错误信息端点</p>\n</li>\n<li data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<p>/oauth/check_token：用于资源服务访问的令牌解析端点，请求参数如下：</p>\n</li>\n</ul>\n</div>\n<table class=\"tableblock frame-all grid-all stretch\">\n<colgroup>\n<col style=\"width: 33.3333%;\">\n<col style=\"width: 33.3333%;\">\n<col style=\"width: 33.3334%;\">\n</colgroup>\n<thead>\n<tr>\n<th class=\"tableblock halign-left valign-top\">参数名称</th>\n<th class=\"tableblock halign-left valign-top\">是否必填</th>\n<th class=\"tableblock halign-left valign-top\">描述</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">token</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">REQUIRED</p></td>\n<td class=\"tableblock halign-left valign-top\"><p class=\"tableblock\">得到的有效的令牌</p></td>\n</tr>\n</tbody>\n</table>\n<div class=\"ulist\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<ul data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<li data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<p>/oauth/token_key：提供公有密匙的端点，如果你使用JWT令牌的话</p>\n</li>\n</ul>\n</div>\n</div>\n</div>\n</div>\n<div class=\"sect1\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<h2 id=\"_技术选型\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">技术选型</h2>\n<div class=\"sectionbody\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<div class=\"ulist\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<ul data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<li data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<p>核心框架：spring boot</p>\n</li>\n<li data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<p>构建工具：maven</p>\n</li>\n<li data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<p>应用框架：spring boot data jpa</p>\n</li>\n<li data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<p>数据库：mysql</p>\n</li>\n<li data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<p>web： spring boot web</p>\n</li>\n<li data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<p>测试框架：junit5、spring boot test</p>\n</li>\n<li data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<p>开发工具：idea</p>\n</li>\n<li data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<p>安全框架：spring security oauth2</p>\n</li>\n</ul>\n</div>\n</div>\n</div>\n<div class=\"sect1\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<h2 id=\"_在这之前\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">在这之前</h2>\n<div class=\"sectionbody\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<div class=\"paragraph\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<p>我们需要对项目的基本初始化，也就是使用 idea 创建我们 spring boot 项目</p>\n</div>\n<div class=\"imageblock\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<div class=\"content\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<img src=\"https://resources.echocow.cn/file/2019/07/08/%E6%B7%B1%E5%BA%A6%E6%88%AA%E5%9B%BE_%E9%80%89%E6%8B%A9%E5%8C%BA%E5%9F%9F_20190709093428.png\" alt=\"1\">\n</div>\n</div>\n<div class=\"imageblock\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<div class=\"content\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<img src=\"https://resources.echocow.cn/file/2019/07/08/%E6%B7%B1%E5%BA%A6%E6%88%AA%E5%9B%BE_plasmashell_20190709093631.png\" alt=\"2\">\n</div>\n</div>\n<div class=\"imageblock\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<div class=\"content\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<img src=\"https://resources.echocow.cn/file/2019/07/08/%E6%B7%B1%E5%BA%A6%E6%88%AA%E5%9B%BE_plasmashell_20190709094513.png\" alt=\"3\">\n</div>\n</div>\n<div class=\"imageblock\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<div class=\"content\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<img src=\"https://resources.echocow.cn/file/2019/07/08/%E6%B7%B1%E5%BA%A6%E6%88%AA%E5%9B%BE_plasmashell_20190709095136.png\" alt=\"4\">\n</div>\n</div>\n<div class=\"paragraph\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<p>父项目忘记添加 web 依赖了，如下：</p>\n</div>\n<div class=\"listingblock\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<div class=\"content\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<pre class=\"highlight\"><code class=\"language-xml\" data-lang=\"xml\">&lt;dependency&gt;\n    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n    &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;\n&lt;/dependency&gt;</code></pre>\n</div>\n</div>\n<div class=\"imageblock\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<div class=\"content\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<img src=\"https://resources.echocow.cn/file/2019/07/08/%E6%B7%B1%E5%BA%A6%E6%88%AA%E5%9B%BE_plasmashell_20190709100047.png\" alt=\"5\">\n</div>\n</div>\n<div class=\"paragraph\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<p><span class=\"image\"><img src=\"https://resources.echocow.cn/file/2019/07/08/%E6%B7%B1%E5%BA%A6%E6%88%AA%E5%9B%BE_%E9%80%89%E6%8B%A9%E5%8C%BA%E5%9F%9F_20190709101728.png\" alt=\"image\"></span></p>\n</div>\n<div class=\"paragraph\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<p>可选，配置阿里云国内源仓库</p>\n</div>\n<div class=\"listingblock\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<div class=\"content\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<pre class=\"highlight\"><code class=\"language-xml\" data-lang=\"xml\">&lt;repositories&gt;\n    &lt;!--阿里云主仓库，代理了maven central和jcenter仓库--&gt;\n    &lt;repository&gt;\n        &lt;id&gt;aliyun&lt;/id&gt;\n        &lt;name&gt;aliyun&lt;/name&gt;\n        &lt;url&gt;https://maven.aliyun.com/repository/public&lt;/url&gt;\n        &lt;releases&gt;\n            &lt;enabled&gt;true&lt;/enabled&gt;\n        &lt;/releases&gt;\n        &lt;snapshots&gt;\n            &lt;enabled&gt;false&lt;/enabled&gt;\n        &lt;/snapshots&gt;\n    &lt;/repository&gt;\n    &lt;!--阿里云代理Spring 官方仓库--&gt;\n    &lt;repository&gt;\n        &lt;id&gt;spring-milestones&lt;/id&gt;\n        &lt;name&gt;Spring Milestones&lt;/name&gt;\n        &lt;url&gt;https://maven.aliyun.com/repository/spring&lt;/url&gt;\n        &lt;releases&gt;\n            &lt;enabled&gt;true&lt;/enabled&gt;\n        &lt;/releases&gt;\n        &lt;snapshots&gt;\n            &lt;enabled&gt;false&lt;/enabled&gt;\n        &lt;/snapshots&gt;\n    &lt;/repository&gt;\n&lt;/repositories&gt;\n&lt;!--远程插件库--&gt;\n&lt;pluginRepositories&gt;\n    &lt;!--阿里云代理Spring 插件仓库--&gt;\n    &lt;pluginRepository&gt;\n        &lt;id&gt;spring-plugin&lt;/id&gt;\n        &lt;name&gt;spring-plugin&lt;/name&gt;\n        &lt;url&gt;https://maven.aliyun.com/repository/spring-plugin&lt;/url&gt;\n        &lt;releases&gt;\n            &lt;enabled&gt;true&lt;/enabled&gt;\n        &lt;/releases&gt;\n        &lt;snapshots&gt;\n            &lt;enabled&gt;false&lt;/enabled&gt;\n        &lt;/snapshots&gt;\n    &lt;/pluginRepository&gt;\n&lt;/pluginRepositories&gt;</code></pre>\n</div>\n</div>\n<div class=\"admonitionblock important\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<table>\n<tbody><tr>\n<td class=\"icon\">\n<i class=\"fa icon-important\" title=\"Important\"></i>\n</td>\n<td class=\"content\">\n注意：请自行配置 lombok 支持！！！\n</td>\n</tr>\n</tbody></table>\n</div>\n<div class=\"paragraph\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<p>这样，我们的父项目基本就构建完成了</p>\n</div>\n<div class=\"paragraph\" data-sal=\"fade\" data-sal-duration=\"500\" data-sal-repeat=\"true\">\n<p>我们下一篇回来完成第二件事，spring security oauth2 自动配置实现。</p>\n</div>\n</div>\n</div>","document":{"title":"Spring Security Oauth2 从零到一完整实践（一）"},"pageAttributes":{"category":"spring","description":"Spring Security Oauth2 从零到一完整实践（一）","image":"https://img.hacpai.com/bing/20180817.jpg?imageView2/1/w/960/h/540/interlace/1/q/100","sort":null}}},"pageContext":{"slug":"/articles/2019/07/14/1563082088646.html","next":{"document":{"title":"Spring Security Oauth2 从零到一完整实践（二）自动配置实现"},"fields":{"slug":"/articles/2019/07/14/1563082247386.html"}},"previous":{"document":{"title":"Manjaro 安装 jdk 8 / docker / docker compose 等常用软件记录"},"fields":{"slug":"/articles/2019/06/20/1561008381459.html"}}}},"staticQueryHashes":["3069561552","3673333084"]}